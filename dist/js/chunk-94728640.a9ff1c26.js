(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-94728640"],{"1b80":function(t,e,a){"use strict";e["a"]={data:function(){return{pagination:{page:1,pageSize:10,total:0,showTotal:function(t,e){return"共 ".concat(t," 条")}}}},computed:{requestData:function(){return{page:this.pagination.page,pageSize:this.pagination.pageSize}}},methods:{init:function(){},pageChange:function(t){this.pagination.page=t,this.requestData.page=t.current,this.init()}}}},3373:function(t,e,a){"use strict";var s=a("aece"),i=a.n(s);i.a},4486:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"members-profile"},[a("a-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:">"}},[a("a-breadcrumb-item",[a("router-link",{attrs:{to:"/"}},[a("a-icon",{attrs:{type:"home"}}),t._v("首页\n      ")],1)],1),a("a-breadcrumb-item",[a("router-link",{attrs:{to:"/members"}},[a("a-icon",{attrs:{type:"team"}}),t._v("成员\n      ")],1)],1),a("a-breadcrumb-item",[t._v(t._s(t.member.name))])],1),a("div",{staticClass:"header"},[a("div",{staticClass:"member-info"},[t.member?[a("div",{staticClass:"base"},[a("a-avatar",{staticClass:"m-r",attrs:{size:"large",icon:"user",src:t.member.avatar}}),a("div",{staticClass:"title"},[t._v(t._s(t.member.name))])],1),a("div",{staticClass:"mail muted"},[a("a-icon",{attrs:{type:"mail"}}),t._v("\n          "+t._s(t.member.email)+"\n          "),a("a-tooltip",[a("template",{slot:"title"},[a("span",[t._v("更新基础资料")])]),a("a",{staticClass:"muted m-l-sm",on:{click:t.syncDetail}},[a("a-icon",{attrs:{type:"reload"}})],1)],2)],1)]:t._e()],2)]),a("div",{staticClass:"actions"},[a("a-tabs",{attrs:{animated:!1,defaultActiveKey:"1"},on:{change:t.tabChange},model:{value:t.tabKey,callback:function(e){t.tabKey=e},expression:"tabKey"}},[a("a-tab-pane",{key:"1",staticClass:"info-content base-info",attrs:{tab:"详细资料"}},[a("p",{staticClass:"action-wrapper"},[a("span",{staticClass:"title"},[t._v("详细资料")]),a("a",{staticClass:"muted",on:{click:t.showEditBaseInfo}},[a("a-icon",{attrs:{type:"edit"}}),t._v("编辑\n          ")],1)]),a("a-row",{staticClass:"content-wrapper"},[a("a-col",{attrs:{span:8}},[a("div",{staticClass:"info-item"},[a("span",{staticClass:"muted"},[t._v("姓名")]),a("span",[t._v(t._s(t.member.name))])])]),a("a-col",{attrs:{span:8}},[a("div",{staticClass:"info-item"},[a("span",{staticClass:"muted"},[t._v("手机")]),a("span",[t._v(t._s(t.member.mobile))])])]),a("a-col",{attrs:{span:8}},[a("div",{staticClass:"info-item"},[a("span",{staticClass:"muted"},[t._v("邮箱")]),a("span",[t._v(t._s(t.member.email))])])]),a("a-col",{attrs:{span:8}},[a("div",{staticClass:"info-item"},[a("span",{staticClass:"muted"},[t._v("职位")]),a("span",[t._v(t._s(t.member.position))])])]),a("a-col",{attrs:{span:8}},[a("div",{staticClass:"info-item"},[a("span",{staticClass:"muted"},[t._v("部门")]),a("span",[t._v(t._s(t.member.departments))])])]),a("a-col",{attrs:{span:8}},[a("div",{staticClass:"info-item"},[a("span",{staticClass:"muted"},[t._v("加入时间")]),a("span",[t._v(t._s(t.member.create_time))])])])],1)],1),a("a-tab-pane",{key:"3",staticClass:"info-content",attrs:{tab:"任务安排"}},[a("p",{staticClass:"action-wrapper"},[a("span",{staticClass:"title"},[t._v("\n            任务安排\n            "),a("a-dropdown",{attrs:{trigger:["click"]}},[a("a",{staticClass:"muted m-l-sm",staticStyle:{"font-size":"14px"}},[0==t.task.type[0]?a("span",[t._v("未完成的任务")]):a("span",[t._v("全部")]),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{staticClass:"field-right-menu",attrs:{slot:"overlay",selectable:""},on:{click:t.changeTaskType},slot:"overlay",model:{value:t.task.type,callback:function(e){t.$set(t.task,"type",e)},expression:"task.type"}},[a("a-menu-item",{key:"0"},[a("div",{staticClass:"menu-item-content"},[a("span",[t._v("未完成的任务")])])]),a("a-menu-item",{key:"-1"},[a("div",{staticClass:"menu-item-content"},[a("span",[t._v("全部")])])])],1)],1)],1)]),a("a-list",{staticClass:"content-wrapper list",attrs:{loading:t.task.loading}},t._l(t.task.list,(function(e,s){return a("a-list-item",{key:s},[a("a-list-item-meta",{on:{click:function(a){return t.showTaskDetail(e)}}},[a("div",{attrs:{slot:"title"},slot:"title"},[e.done?t._e():a("a-icon",{attrs:{type:"border"}}),e.done?a("a-icon",{attrs:{type:"check-square"}}):t._e(),a("span",{staticClass:"m-l-sm"},[t._v(t._s(e.name))]),a("span",{staticClass:"muted m-l tips"},[a("a-icon",{attrs:{type:"project"}}),a("router-link",{staticClass:"muted m-l-xs",attrs:{target:"_blank",to:"/project/space/task/"+e.projectInfo.code}},[t._v(t._s(e.projectInfo.name))])],1),e.end_time?a("span",{staticClass:"label m-r-xs pull-right",class:t.showTimeLabel(e.end_time)},[t._v(t._s(t.showTaskTime(e.begin_time,e.end_time)))]):t._e()],1),a("div",{attrs:{slot:"description"},slot:"description"})])],1)})),1)],1),a("a-tab-pane",{key:"4",staticClass:"info-content",attrs:{tab:"Ta的项目"}},[a("p",{staticClass:"action-wrapper"},[a("span",{staticClass:"title"},[t._v("Ta的项目")])]),a("a-list",{staticClass:"content-wrapper list default-list",attrs:{loading:t.project.loading}},t._l(t.project.list,(function(e,s){return a("a-list-item",{key:s},[a("a-list-item-meta",{on:{click:function(a){return t.routerLink("/project/space/task/"+e.code)}}},[a("a-avatar",{attrs:{slot:"avatar",icon:"user",src:e.cover},slot:"avatar"}),a("div",{attrs:{slot:"title"},slot:"title"},[a("span",{staticClass:"m-l-sm"},[t._v(t._s(e.name))]),a("a-tag",{directives:[{name:"show",rawName:"v-show",value:!e.private,expression:"!item.private"}],staticClass:"m-l",attrs:{color:"green"}},[t._v("公开")])],1),a("div",{attrs:{slot:"description"},slot:"description"},[a("span",{staticClass:"m-l-sm"},[t._v(t._s(e.description))])])],1)],1)})),1)],1)],1)],1),a("a-modal",{attrs:{width:600,title:t.actionInfo.modalTitle,bodyStyle:{padding:"6px 18px 1px 18px"},footer:null},model:{value:t.actionInfo.modalStatus,callback:function(e){t.$set(t.actionInfo,"modalStatus",e)},expression:"actionInfo.modalStatus"}},[a("a-form",{attrs:{form:t.form},on:{submit:function(e){return e.preventDefault(),t.handleSubmitBaseInfo(e)}}},[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"姓名"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请填写姓名"}],validateTrigger:"blur"}],expression:"['name',{rules: [{ required: true, message: '请填写姓名' }], validateTrigger: 'blur'}]"}],attrs:{placeholder:"输入姓名",size:"large"}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"邮箱"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["email",{rules:[{required:!0,message:"请填写电子邮箱地址"}],validateTrigger:"blur"}],expression:"['email',{rules: [{ required: true, message: '请填写电子邮箱地址' }], validateTrigger: 'blur'}]"}],attrs:{placeholder:"输入电子邮箱地址",size:"large"}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"手机"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["mobile"],expression:"['mobile']"}],attrs:{placeholder:"输入手机",size:"large"}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"职位"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["position"],expression:"['position']"}],attrs:{placeholder:"输入职位",size:"large"}})],1)],1)],1),a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{span:24}},[a("a-form-item",{attrs:{label:"描述"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["description"],expression:"['description']"}],attrs:{placeholder:"输入描述",size:"large",type:"textarea",rows:3}})],1)],1)],1),a("a-form-item",[a("div",{staticClass:"action-btn",staticStyle:{"text-align":"center"}},[a("a-button",{staticClass:"middle-btn",attrs:{type:"primary",htmlType:"submit",block:"",size:"large",loading:t.actionInfo.confirmLoading}},[t._v("保存")])],1)])],1)],1),a("a-modal",{staticClass:"task-detail-modal",attrs:{width:"min-content",closable:!1,title:"",footer:null},on:{cancel:t.detailClose},model:{value:t.task.modalStatus,callback:function(e){t.$set(t.task,"modalStatus",e)},expression:"task.modalStatus"}},[t.task.currentTask.code?a("task-detail",{attrs:{taskCode:t.task.currentTask.code},on:{close:t.detailClose}}):t._e()],1)],1)},i=[],r=(a("7f7f"),a("c5f6"),a("009f")),n=a("1b80"),o=a("2f14"),c=a("0672"),l=a("ca8d"),m=a("6be7"),p=a("81fe"),u={name:"MemberProfile",components:{taskDetail:r["default"]},mixins:[n["a"]],data:function(){return{code:this.$route.params.code,tabKey:this.$route.query.key?this.$route.query.key:"1",member:{},task:{page:1,pageSize:1e3,loading:!1,modalStatus:!1,currentTask:{},type:["0"],total:0,list:[]},project:{page:1,pageSize:1e3,loading:!1,total:0,list:[]},form:this.$form.createForm(this),actionInfo:{modalStatus:!1,confirmLoading:!1,modalTitle:"组织成员信息"}}},computed:{},watch:{},created:function(){this.init()},methods:{init:function(){this.getMember(),this.tabChange(this.tabKey)},tabChange:function(t){switch(t){case"3":this.getTasks();break;case"4":this.getProjectList()}},getMember:function(){var t=this;Object(c["q"])(this.code).then((function(e){t.member=e.data}))},syncDetail:function(){var t=this;Object(c["s"])({code:this.code}).then((function(e){t.getMember()}))},getTasks:function(){var t=this;this.task.loading=!0,Object(l["o"])({memberCode:this.member.member_code,type:Number(this.task.type[0]),page:this.task.page,pageSize:this.task.pageSize}).then((function(e){t.task.loading=!1,t.task.list=e.data.list,t.task.total=e.data.total}))},changeTaskType:function(t){var e=this;this.$nextTick((function(){e.getTasks()}))},showTaskDetail:function(t){this.task.currentTask=JSON.parse(JSON.stringify(t)),this.task.modalStatus=!0},detailClose:function(){var t=this;this.task.modalStatus=!1,setTimeout((function(){t.task.currentTask.code=""}),500)},getProjectList:function(){var t=this;this.task.loading=!0,Object(m["l"])({memberCode:this.member.member_code,page:this.task.page,pageSize:this.task.pageSize}).then((function(e){t.project.loading=!1,t.project.list=e.data.list,t.project.total=e.data.total}))},showEditBaseInfo:function(){var t=this;this.actionInfo.modalStatus=!0,this.$nextTick((function(){t.form.setFieldsValue({name:t.member.name,mobile:t.member.mobile,email:t.member.email,position:t.member.position,description:t.member.description})}))},handleSubmitBaseInfo:function(){var t=this,e=this;e.form.validateFields((function(a,s){a||(s.code=e.member.code,Object(c["k"])(s).then((function(a){var i=Object(o["a"])(a);i&&(t.actionInfo.modalStatus=!1,Object.assign(e.member,s))})))}))},showTaskTime:function(t,e){return Object(p["a"])(t,e)},showTimeLabel:function(t){var e="label-primary";if(null==t)return e;var a=moment(moment(t).format("YYYY-MM-DD")).diff(moment().format("YYYY-MM-DD"),"days");return a<0?e="label-danger":0==a?e="label-warning":a>7&&(e="label-normal"),e}}},d=u,f=(a("3373"),a("2877")),b=Object(f["a"])(d,s,i,!1,null,null,null);e["default"]=b.exports},"6be7":function(t,e,a){"use strict";a.d(e,"f",(function(){return i})),a.d(e,"l",(function(){return r})),a.d(e,"e",(function(){return n})),a.d(e,"g",(function(){return o})),a.d(e,"k",(function(){return c})),a.d(e,"i",(function(){return l})),a.d(e,"d",(function(){return m})),a.d(e,"j",(function(){return p})),a.d(e,"h",(function(){return u})),a.d(e,"c",(function(){return d})),a.d(e,"b",(function(){return f})),a.d(e,"a",(function(){return b}));var s=a("22b6");function i(t){return s["a"].post("project/project",t)}function r(t){return s["a"].post("project/project/selfList",t)}function n(t){var e="project/project/save";return t.projectCode&&(e="project/project/edit"),s["a"].post(e,t)}function o(t){return s["a"].post("project/project/quit",{projectCode:t})}function c(t){return s["a"].post("project/project/recycle",{projectCode:t})}function l(t){return s["a"].post("project/project/recovery",{projectCode:t})}function m(t){return s["a"].post("project/project/archive",{projectCode:t})}function p(t){return s["a"].post("project/project/recoveryArchive",{projectCode:t})}function u(t){return s["a"].post("project/project/read",{projectCode:t})}function d(t){return s["a"].post("project/project/analysis",t)}function f(t){return s["a"].post("project/project/_projectStats",t)}function b(t){return s["a"].post("project/project/_getProjectReport",t)}},aece:function(t,e,a){}}]);
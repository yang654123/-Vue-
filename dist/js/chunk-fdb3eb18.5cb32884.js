(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fdb3eb18"],{"1b80":function(t,a,e){"use strict";a["a"]={data:function(){return{pagination:{page:1,pageSize:10,total:0,showTotal:function(t,a){return"共 ".concat(t," 条")}}}},computed:{requestData:function(){return{page:this.pagination.page,pageSize:this.pagination.pageSize}}},methods:{init:function(){},pageChange:function(t){this.pagination.page=t,this.requestData.page=t.current,this.init()}}}},"4cb1":function(t,a,e){"use strict";e.r(a);var n=function(){var t=this,a=this,e=a.$createElement,n=a._self._c||e;return n("div",{staticClass:"project-auth"},[n("wrapper-content",[n("div",{staticClass:"action"},[n("Button",{attrs:{type:"primary",icon:"plus"},on:{click:function(t){return a.rowClick(null,"new")}}},[a._v("添加")])],1),n("Table",{attrs:{columns:a.columns,dataSource:a.data,rowKey:"id",pagination:a.pagination},on:{change:a.pageChange},scopedSlots:a._u([{key:"is_default",fn:function(t,e,i){return[e.is_default?n("a-icon",{attrs:{type:"check"}}):a._e()]}},{key:"action",fn:function(t,e,i){return[n("a",{on:{click:function(t){return a.rowClick(e,"edit")}}},[a._v("编辑")]),n("Divider",{attrs:{type:"vertical"}}),n("router-link",{attrs:{to:"/system/account/apply/"+e.id}},[a._v("授权")]),e.is_default?a._e():[n("Divider",{attrs:{type:"vertical"}}),n("a",{on:{click:function(t){return a.rowClick(e,"is_default")}}},[e.is_default?a._e():n("span",[a._v("设为默认")])])],e.canDelete?[n("Divider",{attrs:{type:"vertical"}}),n("a",{on:{click:function(t){return a.rowClick(e,"del",i)}}},[a._v("删除")])]:a._e()]}}])})],1),n("Modal",{attrs:{title:a.actionInfo.modalTitle,bodyStyle:{paddingBottom:"1px"},footer:null},model:{value:a.actionInfo.modalStatus,callback:function(t){a.$set(a.actionInfo,"modalStatus",t)},expression:"actionInfo.modalStatus"}},[n("Form",{attrs:{autoFormCreate:function(a){t.form=a}},on:{submit:function(t){return t.preventDefault(),a.handleSubmit(t)}}},[n("FormItem",{attrs:{form:a.form,label:"名称",labelCol:{span:3},wrapperCol:{span:21},fieldDecoratorId:"title",fieldDecoratorOptions:{rules:[{required:!0,message:"请输入名称"}]},help:"必填，请填写权限名称（如：财务），用于标记拥有相应权限的角色"}},[n("Input",{attrs:{placeholder:"权限名称"}})],1),n("FormItem",{attrs:{label:"描述",labelCol:{span:3},wrapperCol:{span:21},fieldDecoratorId:"desc",help:"选填，权限描述。"}},[n("Input",{attrs:{placeholder:"权限描述"}})],1),n("FormItem",{attrs:{wrapperCol:{span:21,offset:3}}},[n("div",{staticClass:"action-btn"},[n("Button",{staticClass:"middle-btn",attrs:{type:"primary",htmlType:"submit",loading:a.actionInfo.confirmLoading}},[a._v("保存")]),n("Button",{staticClass:"middle-btn",on:{click:function(t){a.actionInfo.modalStatus=!1}}},[a._v("取消")])],1)])],1)],1)],1)},i=[],o=(e("c5f6"),e("4e72")),r=e("22b6");function s(t){return r["a"].post("project/auth",t)}function l(t){var a="project/auth/add";return t.id&&(a="project/auth/edit"),r["a"].post(a,t)}function c(t,a){return r["a"].post("project/auth/forbid",{id:t,status:a})}function u(t,a){return r["a"].post("project/auth/resume",{id:t,status:a})}function d(t,a){return r["a"].post("project/auth/setDefault",{id:t,is_default:a})}function f(t){return r["a"].post("project/auth/del",{id:t})}var p=e("2f14"),m=e("1b80"),h=o["Form"].Item,w=[{title:"名称",dataIndex:"title",width:"15%"},{title:"描述",dataIndex:"desc",width:"30%"},{title:"默认",dataIndex:"is_default",width:"10%",scopedSlots:{customRender:"is_default"}},{title:"添加时间",dataIndex:"create_at"},{title:"操作",dataIndex:"id",scopedSlots:{customRender:"action"}}],v={components:{Table:o["Table"],Button:o["Button"],Divider:o["Divider"],Modal:o["Modal"],Form:o["Form"],FormItem:h,Input:o["Input"]},mixins:[m["a"]],data:function(){return{columns:w,data:[],newData:null,form:{},actionInfo:{modalStatus:!1,confirmLoading:!1,modalTitle:"编辑权限",okText:"确定",cancelText:"放弃"},authApplyShow:!1,nodeList:[],checkedList:[]}},created:function(){this.init()},methods:{init:function(){var t=this;s(this.requestData).then((function(a){t.data=a.data.list,t.pagination.total=a.data.total}))},rowClick:function(t,a,e){var n=this;if(n.newData=null,"edit"==a||"new"==a)setTimeout((function(){n.form&&n.form.resetFields()}),0),n.actionInfo.modalStatus=!0,n.actionInfo.modalTitle="添加权限","edit"==a?setTimeout((function(){n.actionInfo.modalTitle="编辑权限",n.form.setFieldsValue({title:t.title,desc:t.desc}),n.newData=t}),0):n.newData={status:1,sort:0};else if("status"==a){var i=t.status;t.status=Number(!i),i?c(t.id,t.status):u(t.id,t.status)}else"is_default"==a?d(t.id,1).then((function(t){Object(p["a"])(t)&&n.init()})):"del"==a&&o["Modal"].confirm({title:"确定要删除此权限?",content:"删除后不可恢复",okText:"确定",okType:"danger",cancelText:"放弃",onOk:function(){return f(t.id).then((function(t){Object(p["a"])(t)&&n.data.splice(e,1)})),Promise.resolve()}})},handleSubmit:function(){var t=this;t.form.validateFields((function(a,e){a||t.handleOk()}))},handleOk:function(){var t=this;t.actionInfo.confirmLoading=!0;var a=t.form.getFieldsValue();t.newData.id?a.id=t.newData.id:Object.assign(a,t.newData),console.log(a),l(a).then((function(e){t.actionInfo.confirmLoading=!1,Object(p["a"])(e)&&(t.newData.id?(t.newData.title=a.title,t.newData.desc=a.desc):t.data.push(e.data),t.form.resetFields(),t.newData=null,t.actionInfo.modalStatus=!1)}))}}},b=v,g=e("2877"),I=Object(g["a"])(b,n,i,!1,null,null,null);a["default"]=I.exports}}]);
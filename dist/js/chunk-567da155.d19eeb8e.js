(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-567da155"],{"36bd":function(t,e,o){"use strict";var n=o("4bf8"),r=o("77f1"),a=o("9def");t.exports=function(t){var e=n(this),o=a(e.length),i=arguments.length,s=r(i>1?arguments[1]:void 0,o),l=i>2?arguments[2]:void 0,c=void 0===l?o:r(l,o);while(c>s)e[s++]=t;return e}},4201:function(t,e,o){"use strict";o.r(e);var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"gc-canvas",on:{click:t.reloadPic}},[o("canvas",{attrs:{id:"gc-canvas",width:t.contentWidth,height:t.contentHeight}})])},r=[],a=(o("6c7b"),o("c5f6"),o("0fea")),i={name:"JGraphicCode",props:{length:{type:Number,default:4},fontSizeMin:{type:Number,default:20},fontSizeMax:{type:Number,default:45},backgroundColorMin:{type:Number,default:180},backgroundColorMax:{type:Number,default:240},colorMin:{type:Number,default:50},colorMax:{type:Number,default:160},lineColorMin:{type:Number,default:40},lineColorMax:{type:Number,default:180},dotColorMin:{type:Number,default:0},dotColorMax:{type:Number,default:255},contentWidth:{type:Number,default:136},contentHeight:{type:Number,default:38},remote:{type:Boolean,default:!1,required:!1}},methods:{randomNum:function(t,e){return Math.floor(Math.random()*(e-t)+t)},randomColor:function(t,e){var o=this.randomNum(t,e),n=this.randomNum(t,e),r=this.randomNum(t,e);return"rgb("+o+","+n+","+r+")"},drawPic:function(){var t=this;this.randomCode().then((function(){var e=document.getElementById("gc-canvas"),o=e.getContext("2d");o.textBaseline="bottom",o.fillStyle=t.randomColor(t.backgroundColorMin,t.backgroundColorMax),o.fillRect(0,0,t.contentWidth,t.contentHeight);for(var n=0;n<t.code.length;n++)t.drawText(o,t.code[n],n);t.drawLine(o),t.drawDot(o),t.$emit("success",t.code)}))},drawText:function(t,e,o){t.fillStyle=this.randomColor(this.colorMin,this.colorMax);var n=this.randomNum(this.fontSizeMin,this.fontSizeMax);t.font=n+"px SimHei";var r=10,a=(this.contentWidth-40)/(this.code.length-1),i=r;o>0&&(i=r+o*a);var s=this.randomNum(this.fontSizeMax,this.contentHeight-5);n>40&&(s=40);var l=this.randomNum(-10,10);t.translate(i,s),t.rotate(l*Math.PI/180),t.fillText(e,0,0),t.rotate(-l*Math.PI/180),t.translate(-i,-s)},drawLine:function(t){for(var e=0;e<1;e++)t.strokeStyle=this.randomColor(this.lineColorMin,this.lineColorMax),t.beginPath(),t.moveTo(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight)),t.lineTo(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight)),t.stroke()},drawDot:function(t){for(var e=0;e<100;e++)t.fillStyle=this.randomColor(0,255),t.beginPath(),t.arc(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight),1,0,2*Math.PI),t.fill()},reloadPic:function(){this.drawPic()},randomCode:function(){var t=this;return new Promise((function(e){1==t.remote?Object(a["getAction"])("/sys/getCheckCode").then((function(o){console.log("aaaaa",o),o.success?(t.checkKey=o.result.key,t.code=window.atob(o.result.code),e()):(t.$message.error("生成验证码错误,请联系系统管理员"),t.code="BUG",e())})).catch((function(){console.log("生成验证码连接服务器异常"),t.code="BUG",e()})):(t.randomLocalCode(),e())}))},randomLocalCode:function(){for(var t="",e="QWERTYUPLKJHGFDSAZXCVBNMqwertyupkjhgfdsazxcvbnm1234567890",o=0;o<this.length;o++){var n=Math.floor(57*Math.random());t+=e[n]}this.code=t},getLoginParam:function(){return{checkCode:this.code,checkKey:this.checkKey}}},mounted:function(){this.drawPic()},data:function(){return{code:"",checkKey:""}}},s=i,l=o("2877"),c=Object(l["a"])(s,n,r,!1,null,"6b5c5669",null);e["default"]=c.exports},"6c7b":function(t,e,o){var n=o("5ca1");n(n.P,"Array",{fill:o("36bd")}),o("9c6c")("fill")},f14a:function(t,e,o){"use strict";o.r(e);var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"main"},[o("a-form",{staticStyle:{"max-width":"500px",margin:"40px auto 0"},attrs:{form:t.form},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.nextStep(e)}}},[o("a-form-item",[o("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["username",t.validatorRules.username],expression:"['username',validatorRules.username]"}],attrs:{size:"large",type:"text",autocomplete:"false",placeholder:"请输入用户账号或手机号"}},[o("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),o("a-row",{attrs:{gutter:0}},[o("a-col",{attrs:{span:14}},[o("a-form-item",[o("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["inputCode",t.validatorRules.inputCode],expression:"['inputCode',validatorRules.inputCode]"}],attrs:{size:"large",type:"text",placeholder:"请输入验证码"},on:{change:t.inputCodeChange}},[t.inputCodeContent==t.verifiedCode?o("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"smile"},slot:"prefix"}):o("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"frown"},slot:"prefix"})],1)],1)],1),o("a-col",{attrs:{span:10}},[o("j-graphic-code",{staticStyle:{float:"right"},on:{success:t.generateCode}})],1)],1),o("a-form-item",{attrs:{wrapperCol:{span:19,offset:5}}},[o("router-link",{staticStyle:{float:"left","line-height":"40px"},attrs:{to:{name:"login"}}},[t._v("使用已有账户登录")]),o("a-button",{attrs:{type:"primary"},on:{click:t.nextStep}},[t._v("下一步")])],1)],1)],1)},r=[],a=o("4201"),i=o("0fea"),s=o("4ec3"),l={name:"Step1",components:{JGraphicCode:a["default"]},data:function(){return{form:this.$form.createForm(this),inputCodeContent:"",inputCodeNull:!0,verifiedCode:"",validatorRules:{username:{rules:[{required:!1},{validator:this.validateInputUsername}]},inputCode:{rules:[{required:!0,message:"请输入验证码!"},{validator:this.validateInputCode}]}}}},methods:{nextStep:function(){var t=this;this.form.validateFields((function(e,o){if(!e){var n=!1,r={},a=/^[1-9]\d*$|^0$/,s=o.username;1==a.test(s)?(r.phone=s,n=!0):r.username=s,Object(i["getAction"])("/sys/user/querySysUser",r).then((function(e){if(e.success){var o={username:e.result.username,phone:e.result.phone,isPhone:n};setTimeout((function(){t.$emit("nextStep",o)}))}}))}}))},validateInputCode:function(t,e,o){e&&this.verifiedCode!=this.inputCodeContent?o(new Error("您输入的验证码不正确!")):o()},inputCodeChange:function(t){this.inputCodeContent=t.target.value,console.log(this.inputCodeContent),t.target.value&&0!=t.target.value?(this.inputCodeContent=this.inputCodeContent.toLowerCase(),this.inputCodeNull=!1):this.inputCodeNull=!0},generateCode:function(t){this.verifiedCode=t.toLowerCase(),console.log(this.verifiedCode)},validateInputUsername:function(t,e,o){console.log(e);var n=/^[0-9]+.?[0-9]*/;if(e||o("请输入用户名和手机号！"),n.test(e)){var r={phone:e};Object(s["h"])(r).then((function(t){t.success?o("用户名不存在!"):o()}))}else{r={username:e};Object(s["h"])(r).then((function(t){t.success?o("用户名不存在!"):o()}))}}}},c=l,u=o("2877"),d=Object(u["a"])(c,n,r,!1,null,"912d82e8",null);e["default"]=d.exports}}]);